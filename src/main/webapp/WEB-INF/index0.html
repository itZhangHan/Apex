
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ÓÎÏ·Ò³Ãæ</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport"
	content="width=device-width,initial-scale=1,minimum-
	    scale=1,maximum-scale=1,user-scalable=no">
<script src="../js/webSocket.js"></script>
<script src="../js/userInfo.js"></script>
<script src="../js/jquery-2.1.1.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="../js/square.js"></script>
<script src="../js/squareFactory.js"></script>
<script src="../js/game.js"></script>
<script src="../js/local.js"></script>
<script src="../js/hall.js"></script>
<link rel="stylesheet" href="../css/hall.css">
<script type="text/javascript">
alert("Æô¶¯Ò³Ãæ");
</script>
</head>
<body>

	<div class="centainer">
		<div class="room">
			<span id="roomID"></span> <img id="iconBtn" src="../img/iconBtn.png">
		</div>
		<!-- ±³¾°ÒôÀÖ -->
		<div class="item_btn">
			<ul>
				<li><img id="item1" src="../img/music.png"></li>
			</ul>
		</div>
		<!-- ×ùÎ» -->
		<div class="player_btn">
			<!-- ¿ªÊ¼ÓÎÏ· -->
			<div class="game_go">
				<img id="game_go" onclick="startGame()" src="../img/play/begin.png">
			</div>
			<ul class="sit">
				<li class="sit1" id="player1" value=""><img id="headImg1"
					src=""></li>
				<li class="sit2" id="player2" value=""><img id="headImg2"
					src=" "></li>
				<li class="sit3" id="player3" value=""><img id="headImg3"
					src=" "></li>
				<li class="sit4" id="player4" value=""><img id="headImg4"
					src=" "></li>
			</ul>
		</div>

		<div class="icon-player">
			<ul>
				<li id="icon1"><span id="orPrepare1" style="color: gold">
				</span><img id="img1" src=" "></li>
				<li id="icon2"><span id="orPrepare2" style="color: gold">
				</span> <img id="img2" src=" "></li>
				<li id="icon3"><span id="orPrepare3" style="color: gold">
				</span><img id="img3" src=" "></li>
				<li id="icon4"><span id="orPrepare4" style="color: gold">
				</span><img id="img4" src=" "></li>
				<li id="icon5"><span id="orPrepare5" style="color: gold">
				</span><img id="img5"></li>
				<li id="icon6"><span id="orPrepare6" style="color: gold">
				</span><img id="img6"></li>
				<li id="icon7"><span id="orPrepare7" style="color: gold">
				</span><img id="img7"></li>
				<li id="icon8"><span id="orPrepare8" style="color: gold">
				</span><img id="img8"></li>
			</ul>
		</div>
		<div class="chatRoom" id="chatRoom">

			<!-- <img class="slh" src="../img/play/slh.png"> -->
		</div>
		<div class="ele">
			<input id="sendTxt_0" type="text" maxlength="25" />
			<button id="sendBtn_0">
				<img src="../img/sendBtn.png">
			</button>
		</div>

	</div>
	<!-- ½øÈëÓÎÏ·Ò³Ãæ -->
	<div class="play_go" id="play_go">
		<!-- onload="sendUsers()" -->
		<div class="wrap" id="wrap">
			<div class="local">
				<!-- ¼ÆÊ±ÇøÓò -->
				<div class="time">
					<img src="../img/a/image4.png">
					<div class="info">
						<div>
							<span id="local_time">0</span>
						</div>
					</div>
				</div>
				<!--ÓÎÏ·ÇøÓò  -->
				<div class="gameScene" id="local_gameScene">
					<img src="../img/bg2.png">
					<div class="game" id="local_game"></div>
					<div class="next" id="local_next">
						<img src="../img/a/nextLayer.png">
					</div>
				</div>
				<!-- ÅÅÐÐ°ñÇøÓò -->
				<div class="ranking">
					<ul id="rankingUl">
						<li id="num1">
							<!-- <a><img id="img1" src=""></a>
									<span id="score">000</span> <img id="img2" src="../img/a/d.png">
									<img id="img3" src="../img/a/c.png"> -->
						</li>
						<li id="num2">
							<!-- <a><img id="img4" src=""></a>
									<span id="score1">000</span> <img id="img5" src="../img/a/d.png">
									<img id="img6" src="../img/a/c.png"></li> -->
						<li id="num3">
							<!-- 	<a><img id="img7" src=""></a> 
									<span id="score2">000</span> <img id="img8" src="../img/a/d.png">
									<img id="img9" src="../img/a/c.png"></li> -->
						<li id="num4">
							<!-- <a><img id="img10" src=""></a>
									 <span id="scoreMe">0</span> <img id="img11" src="../img/a/d.png">
									<img id="img12" src="../img/a/c.png"> -->
						</li>
					</ul>
				</div>
				<!-- µÀ¾ßÇøÓò -->
				<div class="stage_btn">
					<ul>
						<li><img id="stage1" src="../img/a/stage2.png"></li>
						<li><img id="stage2" src="../img/a/stage1.png"><span
							id="stage2_num">0</span></li>
					</ul>
				</div>
				<!-- °´¼üÇøÓò -->
				<div class="bottom_btn">
					<ul>
						<li id="btn_left"><img id="btnImg_left"
							src="../img/button4.png"></li>
						<li id="btn_right"><img id="btnImg_right"
							src="../img/button3.png"></li>
						<li id="btn_rotate"><img id="btnImg_rotate"
							src="../img/button1.png"></li>
						<li id="btn_down"><img id="btnImg_down"
							src="../img/button2.png"></li>
					</ul>
				</div>
			</div>
			<canvas id="canvas1"></canvas>
		</div>
	</div>

	<script type="text/javascript">
		var ownerImg = "";
		//Ò³Ãæ¼ÓÔØÇ°·¢ËÍ¸ø·þÎñ¶ËµÄÊý¾Ý
		var imagelist = "";
		var gameGo = document.getElementById("game_go");
		var play_go = document.getElementById("play_go");
		window.onload = function usmessage() {
			//ÅÐ¶Ïµ±Ç°ÓÃ»§ÊÇ·ñÊôÓÚ·¿Ö÷  Èç¹û²»ÊÇ·¿Ö÷ ²»¸øÓÚ¿ªÊ¼ÓÎÏ·µÄ È¨ÏÞ ²¢ÏÔÊ¾·¿Ö÷Ãû×Ö	
			//É¾³ý·¿¼äÂß¼­ÅÐ¶Ï ´Ë´¦ÐèÒª Ôö¼Ó
			var iconBtn = document.getElementById("iconBtn");
			iconBtn.onclick = function() {
				document.location = "http://thdd.apexgame.cn/tetris/skip/first";
			}
<<<<<<< HEAD
			//ÅÐ¶Ïµ±Ç°ÓÃ»§ÊÇ·ñÊôÓÚ·¿Ö÷  Èç¹û²»ÊÇ·¿Ö÷ ²»¸øÓÚ¿ªÊ¼ÓÎÏ·µÄ È¨ÏÞ ²¢ÏÔÊ¾·¿Ö÷Ãû×Ö
			/*if (userStatus != 0) {
				gameGo.style.display = "none";
			} else {
				gameGo.style.display = "block";
			} */
			gameGo.onclick=function(){
=======
			//判断当前用户是否属于房主  如果不是房主 不给于开始游戏的 权限 并显示房主名字
			var gameGo = document.getElementById("game_go");
			var play_go = document.getElementById("play_go");


			if (userStatus != 0) {
				gameGo.style.display = "none";
			} else {
				gameGo.style.display = "block";
			}
			gameGo.onclick = function(b) {
>>>>>>> parent of d8a7935... 35443
				play_go.style.display = "block";
				var local = new Local();
				local.start();
			}
			
			
			var userMessage = {};
			userMessage.type = "usmesage"
			userMessage.roomId = roomId;
			userMessage.toUserName = "";
			userMessage.fromUserName = "";
			userMessage.msgStr = "";
			userMessage.userStatus = userStatus;
			userMessage.roomState = roomState;
			userMessage.position = "1";
			userMessage.headimgurl = img;
			userMessage.nicakname = nicakname;
			userMessage.sex = sex;
			userMessage.city = city;
			userMessage.userId = userId;
			userMessage.props = "";
			userMessage.isSelf = "";
			userMessage.getOnclient = "";
			userMessage.ownerImg = "";
			userMessage.imgOne = "";
			userMessage.imgTwo = "";
			userMessage.imgThree = "";
			userMessage.imgFour = "";
			websocket.send(JSON.stringify(userMessage));
		}
		//¿ªÊ¼ÓÎÏ·ÇëÇó
		function startGame() {
			//Ïë·þÎñ¶Ë·¢Æð¿ªÊ¼ÓÎÏ·ÇëÇó
			var playMessage = {};
			playMessage.type = "gameUsmessage"
			playMessage.roomId = roomId;//·¿¼äid
			playMessage.toUserName = "";//µÀ¾ß¹¥»÷ÈË
			playMessage.fromUserName = "";//µÀ¾ß·¢ÆðÈË
			playMessage.msgStr = "";//µ¯Ä»
			playMessage.userStatus = userStatus;//Íæ¼Ò×´Ì¬
			playMessage.roomState = roomState;
			playMessage.position = "1";
			playMessage.headimgurl = img;//Í·Ïñ
			playMessage.nicakname = nicakname;//Íæ¼ÒÐÕÃû
			playMessage.sex = sex;
			playMessage.city = city;
			playMessage.userId = userId;//userId
			playMessage.props = "";//µÀ¾ßÃû³Æ  
			playMessage.isSelf = "";
			playMessage.getOnclient = "";
			playMessage.ownerImg = "";
			playMessage.imgOne = "";
			playMessage.imgTwo = "";
			playMessage.imgThree = "";
			playMessage.imgFour = "";
			
			websocket.send(JSON.stringify(playMessage));
		}

		//ÅÔ¹ÛÕß
		var headUrl0 = document.getElementById("img1");
		var headUrl1 = document.getElementById("img2");
		var headUrl2 = document.getElementById("img3");
		var headUrl3 = document.getElementById("img4");
		var headUrl4 = document.getElementById("img5");
		var headUrl5 = document.getElementById("img6");
		var headUrl6 = document.getElementById("img7");
		var headUrl7 = document.getElementById("img8");

		//Íæ¼Ò
		var head1 = document.getElementById("headImg1");
		var head2 = document.getElementById("headImg2");
		var head3 = document.getElementById("headImg3");
		var head4 = document.getElementById("headImg4");

		//ÒÑ×¼±¸¶¨Òå 
		var span1 = document.getElementById("orPrepare1");
		var span2 = document.getElementById("orPrepare2");
		var span3 = document.getElementById("orPrepare3");
		var span4 = document.getElementById("orPrepare4");
		var span5 = document.getElementById("orPrepare5");
		var span6 = document.getElementById("orPrepare6");
		var span7 = document.getElementById("orPrepare7");
		var span8 = document.getElementById("orPrepare8");

		//ÑÓ³Ùµ÷ÓÃ ÅÐ¶Ï·¿¼ä×ÜÈËÊý
		function timer() {

			if (userStatus == 0) {
				alert("·¿Ö÷ÍË³ö")
			}

			setTimeout("timer( )", 1000)
		}
		
		var wanjia1 = document.getElementById("player1");
		var wanjia2 = document.getElementById("player2"); 
		var userIdTwo = wanjia2.value;
		wanjia2.onclick = function() {
			//userStatus µ±Ç°ÓÃ»§  0·¿Ö÷  1Íæ¼Ò  2ÅÔ¹ÛÕß
			if (userStatus == 0) {
				alert("·¿Ö÷²»ÄÜ»»×ù");
				return false;
			}
			//µÚ¶þ¸öÎ»ÖÃ ÐÅÏ¢
			
			//var userId2 = wanjia2.value;
			var user2Img = head2.src;
			var subImg2 = user2Img.substr(-20, 20);
			var nowImg = img.substr(-20, 20);
			//alert( "ÅÐ¶Ï·½·¨Ç°"+user2Img);
			if (subImg2 == nowImg) {
				//alert("½øÈëÎ»ÖÃ4µÚÒ»¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨£»£»»º´æµÚÒ»ÏÂ");
				//alert("up");
				showUpHeader("up", 2);
				
			} else if ((document.getElementById("headImg2").src).indexOf('no.jpg') >-1) {
				//alert("½øÈëÎ»ÖÃ4µÚ222¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨");
				//alert("down");
				//	f2 = true;
				showUpHeader("down", 2);
			} else {
			
			alert("×ùÎ»ÓÐÍæ¼Ò£¡");
					
			}
		}
		var wanjia3 = document.getElementById("player3");
		var userIdThree = wanjia3.value;
		wanjia3.onclick = function() {
			if (userStatus == 0) {
				alert("·¿Ö÷²»ÄÜ»»×ù");
				return false;
			}
		//	var userId3 = wanjia3.value;
			var user3Img = document.getElementById("headImg3").src;
			var subImg3 = user3Img.substr(-20, 20);
			var nowImg = img.substr(-20, 20);
		//	alert(userId3+"====µ±Ç°:"+userId);
			//alert( "ÅÐ¶Ï·½·¨Ç°"+user3Img);
			if (subImg3 == nowImg) {
				//alert("½øÈëÎ»ÖÃ4µÚÒ»¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨£»£»»º´æµÚÒ»ÏÂ");
				//alert("up");
				showUpHeader("up", 3);
				
			} else if ((document.getElementById("headImg3").src).indexOf('no.jpg') >-1) {
				//alert("½øÈëÎ»ÖÃ4µÚ222¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨");
				//alert("down");
				//	f2 = true;
				showUpHeader("down", 3);
			} else {
			
			alert("×ùÎ»ÓÐÍæ¼Ò£¡");
					
			}
		}
		var wanjia4 = document.getElementById("player4");
		var userIdFour = document.getElementById("player4").value;
		wanjia4.onclick = function() {
			if (userStatus == 0) {
				alert("·¿Ö÷²»ÄÜ»»×ù");
				return false;
			}
		//	var userId4 = wanjia4.value;
		  //  var  pic=document.getElementById("headImg4").src;
		 // var  _user4Img= document.getElementById("headImg4");
		 // alert(_user4Img);
			var user4Img = document.getElementById("headImg4").src;
			var subImg4 = user4Img.substr(-20, 20);
			var nowImg = img.substr(-20, 20);
			
			//alert( "ÅÐ¶Ï·½·¨Ç°"+user4Img);
			if (subImg4 == nowImg) {
				//alert("½øÈëÎ»ÖÃ4µÚÒ»¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨£»£»»º´æµÚÒ»ÏÂ");
				//alert("up");
				showUpHeader("up", 4);
				
			} else if ((document.getElementById("headImg4").src).indexOf('no.jpg') >-1) {
				//alert("½øÈëÎ»ÖÃ4µÚ222¸öifÓï¾ä=Ö´ÐÐÇëÇóÆðÁ¢·½·¨");
				//alert("down");
				//	f2 = true;
				showUpHeader("down", 4);
			} else {
			
			alert("×ùÎ»ÓÐÍæ¼Ò£¡");
					
			}
			
		}

		//ÁÄÌìÍ¨ÐÅÄ£¿é

		document.getElementById("sendBtn_0").onclick = function() {
			var txt = document.getElementById("sendTxt_0").value;
			div_2 = document.getElementById("chatRoom");
			div_2.style.overflowY = "scroll";
			document.getElementById("sendTxt_0").value = "";
			var mes = {};
			mes.type = "message";
			mes.msgStr = txt;
			mes.roomId = roomId;
			mes.toUserName = ""
			mes.fromUserName = "";
			mes.userStatus = userStatus;
			mes.roomState = roomState;
			mes.roomName = roomName;
			mes.position = ""
			mes.headimgurl = img;
			mes.nicakname = nicakname;
			mes.city = city;
			mes.sex = sex;
			mes.userId = userId;
			mes.props = "";
			mes.isSelf = "";
			mes.getOnclient = "";
			mes.ownerImg = "";
			mes.imgOne = "";
			mes.imgTwo = "";
			mes.imgThree = "";
			mes.imgFour = "";
			websocket.send(JSON.stringify(mes));
		}
		//½ÓÊÕÆðÁ¢type Õ¹Ê¾Êý¾Ý
		function showUpmessage(b, imagelist) {

			if (b.position == '2') {
				//var head2 = document.getElementById("headImg2");
				//Í¸Ã÷Í¼Æ¬
				head2.src = 'no.jpg';
				//orPrepare2.innerHTML = "";
			//	var uid2=document.getElementById("player2");
				userIdTwo = '';

			} else if (b.position == '3') {
				head3.src = 'no.jpg';
				//orPrepare3.innerHTML = ""
				//var uid3=document.getElementById("player3");
				userIdThree= '';
			} else if (b.position == '4') {
				head4.src = 'no.jpg';
				//orPrepare4.innerHTML = ""
				//var uid4=document.getElementById("player4");
				document.getElementById("player4").value = '';
			}

			var zuowei = b.position;
			for (var i = 1; i <= 4; i++) {
				//»ñÈ¡ËÄ¸öÍæ¼ÒÍ·Ïñ
				var headImage = document.getElementById("headImg" + i);
				var player = document.getElementById("player" + i);
				if (i != zuowei) {
					//alert(headImage.src+"+")

					if (headImage.src == b.headimgurl) {
						headImage.src = '';
						player.value = '';
					}

					//alert("22222"+headImage.src);
				}

			}
			for (var z = 1; z <= 8; z++) {

				var teas111 = document.getElementById("img" + z);

				if (imagelist.indexOf(teas111.src) > -1 && teas111.src != "") {
					document.getElementById("orPrepare" + z).innerHTML = "ÒÑ×¼±¸";
				} else {
					document.getElementById("orPrepare" + z).innerHTML = "";
				}
				if (ownerImg == teas111.src) {
					document.getElementById("orPrepare1").innerHTML = "";
				}
			}

		}

		function findCache(imagelist, b) {
				//¸øÎ»ÖÃÌî³äÍ¼Æ¬  ·¿Ö÷
				document.getElementById("headImg1").src = b.imgOne;
		

				if(b.imgTwo != "")
					document.getElementById("headImg2").src = b.imgTwo;
				else
					document.getElementById("headImg2").src = 'no.jpg';
					
				if(b.imgThree != "")
					document.getElementById("headImg3").src = b.imgThree;
				else
					document.getElementById("headImg3").src = 'no.jpg';
				if(b.imgFour != "")
					document.getElementById("headImg4").src = b.imgFour;
				else
					document.getElementById("headImg4").src = 'no.jpg';
			
		
			var rankingUl = document.getElementById("rankingUl");
			rankingUl.innerHTML = "<li id='num1'>"
					+ "<a><img id='img_1' src='"+b.imgOne+"'></a>"
					+ "<span id='score'>000</span> <img id='img_2' src='../img/a/d.png'>"
					+ "<img id='img_3' src='../img/a/c.png'>"
					+ "</li>"
					+ "<li id='num2'>"
					+ "<a><img id='img_4' src='"+b.imgTwo+"'></a>"
					+ "<span id='score1'>000</span> <img id='img_5' src='../img/a/d.png'>"
					+ "<img id='img_6' src='../img/a/c.png'></li>"
					+ "<li id='num3'>"
					+ "<a><img id='img_7' src='"+b.imgThree+"'>></a>"
					+ "<span id='score2'>000</span> <img id='img_8' src='../img/a/d.png'>"
					+ "<img id='img_9' src='../img/a/c.png'>"
					+ "</li>"
					+ "<li id='num4'>"
					+ "<a><img id='img_10' src='"+b.imgFour+"'></a>"
					+ "<span id='scoreMe'>0</span> <img id='img_11' src='../img/a/d.png'>"
					+ "<img id='img_12' src='../img/a/c.png'>" + "</li>"

			/* 	alert(imagelist+"=imagelist");
				var xiaomao=document.getElementById("headImg2");
				alert(xiaomao.src+"Ð¡Ã¨");  */
			for (var z = 1; z <= 8; z++) {

				var teas111 = document.getElementById("img" + z);
				/* if (z == 1) {
					alert(imagelist + "zzzz--1--zzzz" + teas111.src);
					alert(imagelist.indexOf(teas111.src));
				} */
				if (imagelist.indexOf(teas111.src) > -1 && teas111.src != "") {
					//alert("½øÈëÒÑ×¼±¸");
					document.getElementById("orPrepare" + z).innerHTML = "ÒÑ×¼±¸";
				} else {
					//alert("½øÈëÈ¡Ïû×¼±¸");
					document.getElementById("orPrepare" + z).innerHTML = "";
				}
				if (ownerImg == teas111.src) {
					//alert("½øÈë·¿Ö÷");
					document.getElementById("orPrepare1").innerHTML = "";
				}

			}

			/* var zuowei = b.position;
			for (var i = 1; i <= 4; i++) {
				var headImage = document.getElementById("headImg" + i);
				//var player = document.getElementById("player" + i);
				if (i != zuowei) {
					//alert(headImage.src+"+")		
					if (headImage.src == b.headimgurl) {
						headImage.src = '../img/play/touming.jpg';
					//	player.value = '';
					}
					//alert("22222"+headImage.src);
				}
			}
			//ËÄÈË×ùÎ»src 
			//var piclisti=head1.src+","+head2.src+","+head3.src+","+head4.src;
			//orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3
			for (var z = 1; z <= 8; z++) {

				var teas111 = document.getElementById("img" + z);

				if (imagelist.indexOf(teas111.src) > -1 && teas111.src != "") {
					document.getElementById("orPrepare" + z).innerHTML = "ÒÑ×¼±¸";
				} else {
					document.getElementById("orPrepare" + z).innerHTML = "";
				}
				if (ownerImg == teas111.src) {

					document.getElementById("orPrepare1").innerHTML = "";
				}

			} */
		}
		//½ÓÊÕ×øÏÂtype Õ¹Ê¾Êý¾Ý
		function showDownmessage(b, imagelist) {
			//	alert("½øÈëdown·½·¨ÁË");
			var sitUl = document.getElementsByClassName("sit");
			var hd1src = head1.src;
			var hd2src = head2.src;
			var hd3src = head3.src;
			var hd4src = head4.src;
			//var iimg1 = document.getElementById("headImg1");

			//alert("111"+b.imgOne);
			//alert("userid="+b.userId);
			if (b.position == '1') {
				//¸øÎ»ÖÃÌî³äÍ¼Æ¬
				head1.src = b.imgOne;
				//ÐÞ¸ÄÅÔ¹ÛÕßÐÅÏ¢Îª ÒÑ×¼±¸
				/* orPrepare2.innerHTML = "ÒÑ×¼±¸";  */
				//ÉèÖÃÍ·ÏñvalueÎªuserid
				userId1 = b.userId;
				//±éÀúÍ·Ïñ ÉèÖÃÖ®Ç°Í·ÏñÏûÊ§

			}
			if (b.position == '2') {
				//var uid2 = document.getElementById("player2");
				//¸øÎ»ÖÃÌî³äÍ¼Æ¬
				//alert("½øÈë22222");
				head2.src = b.imgTwo;
				//ÐÞ¸ÄÅÔ¹ÛÕßÐÅÏ¢Îª ÒÑ×¼±¸
				/* orPrepare2.innerHTML = "ÒÑ×¼±¸";  */
				//ÉèÖÃÍ·ÏñvalueÎªuserid
				userIdTwo = b.userId;
				//±éÀúÍ·Ïñ ÉèÖÃÖ®Ç°Í·ÏñÏûÊ§

			}
			if (b.position == '3') {
				//alert("½øÈë333"+b.imgThree);	
				head3.src = b.imgThree;
				//orPrepare3.innerHTML = "ÒÑ×¼±¸"; 
				userIdThree = b.userId;
				//±éÀúÍ·Ïñ ÉèÖÃÖ®Ç°Í·ÏñÏûÊ§
			}
			if (b.position == '4') {
				//alert("4444×øÏÂ ¸³Öµ="+b.imgFour)
				head4.src = b.imgFour;
				//orPrepare4.innerHTML = "ÒÑ×¼±¸";  
				document.getElementById("player4").value = b.userId;
				//±éÀúÍ·Ïñ ÉèÖÃÖ®Ç°Í·ÏñÏûÊ§
			}
			//ÇåÀíÔ­À´×ùÎ»
			var zuowei = b.position;
			for (var i = 1; i <= 4; i++) {
				var headImage = document.getElementById("headImg" + i);
				var player = document.getElementById("player" + i);
				if (i != zuowei) {
					//alert(headImage.src+"+")		
					if (headImage.src == b.headimgurl) {
						headImage.src = '';
						player.value = '';
					}
					//alert("22222"+headImage.src);
				}
			}
			//ËÄÈË×ùÎ»src 
			//var piclisti=head1.src+","+head2.src+","+head3.src+","+head4.src;
			//orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3orPrepare3
			for (var z = 1; z <= 8; z++) {

				var teas111 = document.getElementById("img" + z);

				if (imagelist.indexOf(teas111.src) > -1 && teas111.src != "") {
					document.getElementById("orPrepare" + z).innerHTML = "ÒÑ×¼±¸";
				} else {
					document.getElementById("orPrepare" + z).innerHTML = "";
				}
				if (ownerImg == teas111.src) {

					document.getElementById("orPrepare1").innerHTML = "";
				}

			}

		}
		//½ÓÊÕÓÎÏ·ÀàÐÍ ÉèÖÃÓÎÏ·¿ªÊ¼
		function actionGame(b, imagelist) {

			//µ±½ÓÊÕµ½·µ»Ø·¿¼ä×´Ì¬Îª1Ê±ºòÌø×ªµ½¿ªÊ¼ÓÎÏ·½çÃæ
			for (var z = 1; z <= 8; z++) {

				var teas111 = document.getElementById("img" + z);
				if (imagelist.indexOf(teas111.src) > -1) {
					play_go.style.display = "block";
					var local = new Local();
					local.start();
				}
			}
			/* if (img == head1.src || img == head2.src || img == head3.src
					|| img == head4.src) {
				//µ±·¿¼ä×´Ì¬Îª1Ê±ºòÅÐ¶ÏÍæ¼Ò×´Ì¬
				//½«Íæ¼Ò×´Ì¬Îª1(×¼±¸Íæ¼Ò)µÄÍæ¼ÒÌø×ªµ½ÓÎÏ·Ò³Ãæ
				//ÆäÓàÅÔ¹ÛÕß²»Óè¸Ä±ä
				play_go.style.display = "block";
				var local = new Local();
				local.start();
			} */
		}
		//ÏÔÊ¾·ÖÊýÐÅÏ¢
		function showScore(b) {

		}

		//½ÓÊÕ·¿¼äËùÓÐÐÅÏ¢£¬Õ¹Ê¾ÓÃ»§ÐÅÏ¢
		function showMessage(b) {

			var str = b.msgStr;
			var imgSock = b.headimgurl;
			var nicakname = b.nickName;
			var div_3 = document.createElement("div");
			div_3.style.fontSize = "20px";
			div_3.style.wordBreak = "break-all"
			div_3.style.marginTop = "1px";
			div_3.style.dispaly = "block";
			var ss = 7;
			//b.isSelf == "1"
			if (b.userId == userId) {
				//±¾ÈË
				div_3.innerHTML += "<li style='clear:both;font-size:20px'>"
						+ "<div><img class='imgright' src='"+imgSock+"'></div>"
						+ "<div  class='sockitnamer'>"
						+ "<h2  style='font-size:11px'class='hostName nameRight'>"
						+ nicakname + "</h2>"
						+ "<p style='font-size:11px;' class='nameB' >" + str
						+ "</p>" + "</div>" + "</li>"
			} else {
				//±ðÈË 2s
				div_3.innerHTML += "<li style='clear:both;font-size:20px'>"
						+ "<div><img class='imgleft' src='"+imgSock+"'>"
						+ "</div>" + "<div class='sockitnamel'>"
						+ "<h2  style='font-size:11px'class='hostName'>"
						+ nicakname + "</h2>" + "<p style='font-size:11px;'>"
						+ str + "</p>" + "</div>" + "</li>"
			}

			div_2.appendChild(div_3)
			div_2.scrollTop = div_2.scrollHeight;

		}
		//·¿Ö÷Ãû×Ö

		websocket.onmessage = function(e) {
			//alert("ÎÒµÄuserId="+userId);
			//	alert("×Ô¼ºµÄÍ·Ïñ="+img);
			var jsonObj = eval("(" + e.data + ")");
			console.log(jsonObj);
			var b = JSON.parse(jsonObj);
			//var nowImgs = b.listImgs;
			//alert(nowImgs[0].nowImg+"==ÕâÐ©£¡");
			var returnLists = b.listImgs;
			//·¿Ö÷Í·Ïñ
			ownerImg = b.headimgurl;

			imagelist = "";

			//Í¼Æ¬Êý×é 
			imagelist = imagelist + b.imgOne + "---" + b.imgTwo + "---"
					+ b.imgThree + "---" + b.imgFour;
			// alert("Êý¾Ý¿âÖÐÎ»ÖÃÒ»µÄÍ¼Æ¬="+b.imgOne + ",,,Î»ÖÃ¶þµÄÍ¼Æ¬"+b.imgTwo + ",,,Î»ÖÃÈýµÄÍ¼Æ¬"+b.imgThree
			// 	+ ",,,Î»ÖÃËÄµÄÍ¼Æ¬"+b.imgFour);
			//ÌáÈ¡»º´æÊý¾Ý
			showUserList(b.listUsers);
			findCache(imagelist, b);
			//alert("µ¯³ö1");
			if (b.type == 'usmesage') {

				var openRoom = document.getElementById("roomID");
				openRoom.innerText = b.roomName;
				//var openRoom = document.getElementById("roomID");
				//ÏÔÊ¾ÅÔ¹ÛÕßÐÅÏ¢
				showHeadImg(b.listUsers);
				showUserList(b.listUsers);

			}
			//ÔÊÐí»»×ö ¸ø½«Òª×øµÄÎ»ÖÃÌî³äÍ¼Æ¬
		//	alert(b.type+" ============= "+"Êý¾Ý¿âÖÐÎ»ÖÃÒ»µÄÍ¼Æ¬="+b.imgOne + "|||||||Î»ÖÃ¶þµÄÍ¼Æ¬"+b.imgTwo + "|||||||Î»ÖÃÈýµÄÍ¼Æ¬="+b.imgThree
			//	 	+ "|||||||Î»ÖÃËÄµÄÍ¼Æ¬=mx"+b.imgFour);
			
			if (b.type == 'changeSeat') {
				showChangeSeat(b);
			}
			if (b.type == 'message') {
				//Õ¹Ê¾·¢ËÍÏûÏ¢Êý¾Ý
				showMessage(b);
			}
			if (b.type == 'up') {
				//Õ¹Ê¾ÆðÁ¢ÐÅÏ¢
				showUpmessage(b, imagelist);
			}
			if (b.type == 'down') {
				//Õ¹Ê¾×øÏÂÐÅÏ¢
				showDownmessage(b, imagelist);

			}
			if (b.type == 'roomStatus') {
				//Õ¹Ê¾ÓÎÏ·¿ªÊ¼Êý¾Ý
				actionGame(b);
			}
			if (b.type == 'score') {
				//Õ¹Ê¾·ÖÊýÐÅÏ¢
				showScore(b);
			}
			//·Ö·¢¿ªÊ¼ÓÎÏ·
			if (b.type == 'actionGame') {
				actionGame(b, imagelist);
			}
		}

		//ÏÔÊ¾ÅÔ¹ÛÕßÐÅÏ¢
		function showUserList(listUsers) {
			for (var i = 0; i < listUsers.length; i++) {

				document.getElementById("img" + (i + 1)).src = listUsers[i].userportrait;

			}
		}

		function showHeadImg(listUsers) {
			for (var i = 0; i < listUsers.length; i++) {
				if (listUsers[i].status == 0) {
					headImg1.src = listUsers[i].userportrait;
					headImg1.onclick = function() {
						alert("ÄãÊÇ·¿Ö÷£¡");
					}
				}
				if (listUsers[i].status == 1) {
					if (listUsers[i].headPostion == 1)
						headImg1.src = listUsers[i].userportrait;
					if (listUsers[i].headPostion == 2)
						headImg2.src = listUsers[i].userportrait;
					if (listUsers[i].headPostion == 3)
						headImg3.src = listUsers[i].userportrait;
					if (listUsers[i].headPostion == 4)
						headImg4.src = listUsers[i].userportrait;
				}
			}
		}

		function showUpHeader(ud, position) {
			
			
			var upDown = {};
			upDown.type = ud;
			upDown.roomId = roomId;
			upDown.toUserName = "2";
			upDown.fromUserName = " ";
			upDown.msgStr = "";
			upDown.userStatus = userStatus;
			upDown.roomState = roomState;
			upDown.position = position
			upDown.headimgurl = img;
			upDown.nicakname = nicakname;
			upDown.sex = sex;
			upDown.city = city;
			upDown.userId = userId;
			upDown.props = "";
			upDown.isSelf = "";
			upDown.getOnclient = "";
			upDown.ownerImg = "";
			upDown.imgOne = "";
			upDown.imgTwo = "";
			upDown.imgThree = "";
			upDown.imgFour = "";
			websocket.send(JSON.stringify(upDown));
		}

		document.getElementById("sendBtn_0").onclick = function() {
			var txt = document.getElementById("sendTxt_0").value;
			div_2 = document.getElementById("chatRoom");
			div_2.style.overflowY = "scroll";//auto    scroll						
			document.getElementById("sendTxt_0").value = "";
			var mes = {};
			mes.type = "message";
			mes.msgStr = txt;
			mes.roomId = roomId;
			mes.toUserName = ""
			mes.fromUserName = "";
			mes.userStatus = userStatus;
			mes.roomState = roomState;
			mes.roomName = roomName;
			mes.position = ""
			mes.headimgurl = img;
			mes.nicakname = nicakname;
			mes.city = city;
			mes.sex = sex;
			mes.userId = userId;
			mes.props = "";
			mes.isSelf = "";
			mes.getOnclient = "";
			mes.ownerImg = "";
			mes.imgOne = "";
			mes.imgTwo = "";
			mes.imgThree = "";
			mes.imgFour = "";
			websocket.send(JSON.stringify(mes));
		}
		function sendUsers() {

			var readingUsers = {};
			readingUsers.type = "gameUsmessage"
			readingUsers.roomId = "1001";
			readingUsers.toUserName = "";
			readingUsers.fromUserName = "";
			readingUsers.msgStr = "";
			readingUsers.userStatus = "0";
			readingUsers.roomState = "1";
			readingUsers.position = "";
			readingUsers.headimgurl = "";
			readingUsers.nicakname = "zhangsan";
			readingUsers.sex = "1";
			readingUsers.city = "beijing";
			readingUsers.userId = "50";
			readingUsers.props = "µÀ¾ß";
			readingUsers.isSelf = "";
			readingUsers.getOnclient = "";
			readingUsers.ownerImg = "";
			readingUsers.imgOne = "";
			readingUsers.imgTwo = "";
			readingUsers.imgThree = "";
			readingUsers.imgFour = "";
			websocket.send(JSON.stringify(readingUsers));

		}
	</script>
	<!-- ²âÊÔ -->
	<!-- CESHI22 -->

	
</body>
</html>